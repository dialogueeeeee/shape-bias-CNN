# shape-bias-CNN
一种跨域形状偏好 CNN 设计与实现
## 基于基础形状数据集的分类任务
基础形状分类任务
### 基础形状数据集
生成基础形状数据集
### 训练结果
结果展示

## 基于组合复杂形状数据集的分类任务
组合复杂形状分类任务，目的是通过学习复杂形状可以由简单形状组合得到，加深网络对形状的理解。
### 组合复杂形状数据集
- 通过 `complicated-shape-generation.py` 文件生成复杂形状；
- 本项目中，复杂形状定义是由多种简单形状组合生成。具体来说，通过**矩形、圆形、椭圆、三角形**四种简单形状任意组合，共 15 种组合方式，分别生成不同颜色的任意形状；
- 本项目中，第一版本复杂形状最终生成 **15** 个类，每类 **460** 张，共 **6900** 张复杂形状数据集的图像。第一个版本中同一张图片中，形状的线宽和颜色都相同，主要考虑不想让网络通过颜色和线宽的“捷径”来区分形状，而是通过形状的内在特征。示例如下（示例分别为矩形三角形组合，圆形椭圆形组合）。

![image](https://user-images.githubusercontent.com/59753705/157893057-3fe40c25-7640-48cf-901b-5db6c07ddb6d.png)
![image](https://user-images.githubusercontent.com/59753705/157893309-77dc9482-2838-4d6a-898e-5b79ab02628e.png)

- 第二版本复杂形状增加了不同颜色、不同线宽的形状，每类增加 **240** 张，共 **700** 张图片。然后每张图像生成一张风格化图像，每类生成 **700** 张风格化图像。综上所述，第二个版本复杂形状最终生成 **15** 个类，每类 **1400** 张，共 **21000** 张图片。新增图像示例如下。

![image](https://user-images.githubusercontent.com/59753705/158727143-62aa5d09-592a-4bc8-85c8-3790bc944429.png)
![image](https://user-images.githubusercontent.com/59753705/158727068-95a6adb0-2e56-4426-bab6-19b239611ce7.png)



## 基于双任务的形状理解网络
- 本项目通过同时训练两个形状相关任务，希望网络加强对形状的理解，并在迁移学习中获得形状偏好；
- 任务一：基于基础形状数据集的（10 类）分类任务，任务 1 详情可见文件夹 ``shape-classification``；
- 任务二：基于组合复杂形状数据集的（15 类）分类任务，任务 2 详情可见文件夹 ``complicated-shape-classification``；
- 联合损失函数：**L_total = L1 + α * L2** ，其中 α 为可调超参数。
- 以下是基于双任务的形状理解网络训练原理示意图。
![双任务预训练结构02](https://user-images.githubusercontent.com/59753705/158997620-26a9f09e-a258-418a-b75a-71eaac26350a.png)

## 基于形状理解网络的迁移学习研究
基于形状理解网络的迁移学习研究
### 迁移学习形状偏好研究 (shape-bias) 
- salience maps
- Saturation
- patch-shuffle
### 迁移学习跨域分类任务
PACS dataset
### 迁移学习小样本分类任务
few-shot classification
